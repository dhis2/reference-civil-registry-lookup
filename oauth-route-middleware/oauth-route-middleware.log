2024-09-20T10:25:59.638+02:00  WARN 32156 --- [main] ory$DuplicateJsonObjectContextCustomizer : 

Found multiple occurrences of org.json.JSONObject on the class path:

	jar:file:/C:/Users/JohanGangs%c3%a5sHole/.m2/repository/org/json/json/20240303/json-20240303.jar!/org/json/JSONObject.class
	jar:file:/C:/Users/JohanGangs%c3%a5sHole/.m2/repository/com/vaadin/external/google/android-json/0.0.20131108.vaadin1/android-json-0.0.20131108.vaadin1.jar!/org/json/JSONObject.class

You may wish to exclude one of them to ensure predictable runtime behavior

2024-09-20T10:25:59.651+02:00  INFO 32156 --- [main] d.i.c.HawtioWebConsoleFunctionalTestCase : Starting HawtioWebConsoleFunctionalTestCase using Java 19.0.1 with PID 32156 (started by JohanGangsåsHole in C:\Users\JohanGangsåsHole\Desktop\Work\repos\reference-fhir-civil-registry-lookup\oauth-route-middleware)
2024-09-20T10:25:59.653+02:00  INFO 32156 --- [main] d.i.c.HawtioWebConsoleFunctionalTestCase : The following 1 profile is active: "test"
2024-09-20T10:26:01.814+02:00  INFO 32156 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 0 (http)
2024-09-20T10:26:01.826+02:00  INFO 32156 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2024-09-20T10:26:01.827+02:00  INFO 32156 --- [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.19]
2024-09-20T10:26:01.929+02:00  INFO 32156 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2024-09-20T10:26:01.929+02:00  INFO 32156 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1991 ms
2024-09-20T10:26:02.206+02:00  INFO 32156 --- [main] o.s.b.a.e.web.ServletEndpointRegistrar   : Registered '/management/jolokia' to jolokia-actuator-endpoint
2024-09-20T10:26:02.228+02:00  INFO 32156 --- [main] io.hawt.HawtioContextListener            : Initialising Hawtio services
2024-09-20T10:26:02.331+02:00  INFO 32156 --- [main] io.hawt.jmx.JmxTreeWatcher               : Welcome to Hawtio 4.0.0
2024-09-20T10:26:02.339+02:00  INFO 32156 --- [main] i.h.w.auth.AuthenticationConfiguration   : Authentication throttling is enabled
2024-09-20T10:26:02.381+02:00  INFO 32156 --- [main] i.h.w.auth.AuthenticationConfiguration   : Starting hawtio authentication filter, JAAS authentication disabled
2024-09-20T10:26:02.390+02:00  INFO 32156 --- [main] io.hawt.web.auth.LoginRedirectFilter     : Hawtio loginRedirectFilter is using 1800 sec. HttpSession timeout
2024-09-20T10:26:03.590+02:00  INFO 32156 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 18 endpoint(s) beneath base path '/management'
2024-09-20T10:26:03.683+02:00  INFO 32156 --- [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@4c12f54a, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@334d825c, org.springframework.security.web.context.SecurityContextHolderFilter@c14bbab, org.springframework.security.web.header.HeaderWriterFilter@5b74bb75, org.springframework.web.filter.CorsFilter@42a7e7e1, org.springframework.security.web.csrf.CsrfFilter@6ac83e67, org.springframework.security.web.authentication.logout.LogoutFilter@7cc3a7f7, org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter@1e38e8b6, org.springframework.security.web.authentication.ui.DefaultLoginPageGeneratingFilter@758311ed, org.springframework.security.web.authentication.ui.DefaultLogoutPageGeneratingFilter@e2d9923, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@6bd28e4a, org.hisp.dhis.integration.camel.security.DefaultSecurityConfig$CsrfCookieFilter@554e9509, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@4a0c04ab, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@453439e, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@acea29e, org.springframework.security.web.access.ExceptionTranslationFilter@2e5c7cd5, org.springframework.security.web.access.intercept.AuthorizationFilter@3911fec8]
2024-09-20T10:26:04.551+02:00  INFO 32156 --- [main] o.a.c.c.s.CamelHttpTransportServlet      : Initialized CamelHttpTransportServlet[name=CamelServlet, contextPath=]
2024-09-20T10:26:04.552+02:00  INFO 32156 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 50296 (http) with context path ''
2024-09-20T10:26:06.581+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   : Apache Camel 4.5.0 (camel-1) is starting
2024-09-20T10:26:06.840+02:00  INFO 32156 --- [main] c.s.b.CamelSpringBootApplicationListener : Starting CamelMainRunController to ensure the main thread keeps running
2024-09-20T10:26:06.841+02:00  INFO 32156 --- [CamelMainRunController] org.apache.camel.main.MainSupport        : Apache Camel (Main) 4.5.0 is starting
2024-09-20T10:26:06.866+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   : Routes startup (total:3 rest-dsl:1)
2024-09-20T10:26:06.866+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   :     Started openHimRegisterRoute (timer://registerOpenHimMediator)
2024-09-20T10:26:06.866+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   :     Started openHimHeartbeatRoute (timer://heartbeatOpenHimMediator)
2024-09-20T10:26:06.867+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   :     Started route1 (rest://get:/orgUnits)
2024-09-20T10:26:06.867+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   : Apache Camel 4.5.0 (camel-1) started in 285ms (build:0ms init:0ms start:285ms)
2024-09-20T10:26:06.873+02:00  INFO 32156 --- [main] d.i.c.HawtioWebConsoleFunctionalTestCase : Started HawtioWebConsoleFunctionalTestCase in 7.551 seconds (process running for 8.659)
2024-09-20T10:26:08.152+02:00 ERROR 32156 --- [Camel (camel-1) thread #1 - timer://registerOpenHimMediator] o.a.c.p.e.DefaultErrorHandler            : Failed delivery for (MessageId: CFAB2E92F46D010-0000000000000000 on ExchangeId: CFAB2E92F46D010-0000000000000000). Exhausted after delivery attempt: 1 caught: org.apache.hc.client5.http.HttpHostConnectException: Connect to https://localhost:8080 [localhost/127.0.0.1, localhost/0:0:0:0:0:0:0:1] failed: Connection refused: no further information

Message History (source location and message history is disabled)
---------------------------------------------------------------------------------------------------------------------------------------
Source                                   ID                             Processor                                          Elapsed (ms)
                                         openHimRegisterRoute/openHimRe from[timer://registerOpenHimMediator?repeatCount=1          280
	...
                                         openHimRegisterRoute/toD1      {{openhim.url}}/mediators?httpClientConfigurer=#se            0

Stacktrace
---------------------------------------------------------------------------------------------------------------------------------------

org.apache.hc.client5.http.HttpHostConnectException: Connect to https://localhost:8080 [localhost/127.0.0.1, localhost/0:0:0:0:0:0:0:1] failed: Connection refused: no further information
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:535) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:585) ~[na:na]
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:666) ~[na:na]
	at org.apache.hc.client5.http.ssl.SSLConnectionSocketFactory.lambda$connectSocket$0(SSLConnectionSocketFactory.java:246) ~[httpclient5-5.2.3.jar:5.2.3]
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:569) ~[na:na]
	at org.apache.hc.client5.http.ssl.SSLConnectionSocketFactory.connectSocket(SSLConnectionSocketFactory.java:245) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.io.DefaultHttpClientConnectionOperator.connect(DefaultHttpClientConnectionOperator.java:184) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.io.PoolingHttpClientConnectionManager.connect(PoolingHttpClientConnectionManager.java:447) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.InternalExecRuntime.connectEndpoint(InternalExecRuntime.java:162) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.InternalExecRuntime.connectEndpoint(InternalExecRuntime.java:172) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.ConnectExec.execute(ConnectExec.java:142) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.ExecChainElement.execute(ExecChainElement.java:51) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.ProtocolExec.execute(ProtocolExec.java:192) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.ExecChainElement.execute(ExecChainElement.java:51) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.HttpRequestRetryExec.execute(HttpRequestRetryExec.java:96) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.ExecChainElement.execute(ExecChainElement.java:51) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.ContentCompressionExec.execute(ContentCompressionExec.java:152) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.ExecChainElement.execute(ExecChainElement.java:51) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.camel.component.http.PreemptiveAuthExecChainHandler.execute(PreemptiveAuthExecChainHandler.java:70) ~[camel-http-4.5.0.jar:4.5.0]
	at org.apache.hc.client5.http.impl.classic.ExecChainElement.execute(ExecChainElement.java:51) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.InternalHttpClient.doExecute(InternalHttpClient.java:170) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.CloseableHttpClient.execute(CloseableHttpClient.java:245) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.camel.component.http.HttpProducer.executeMethod(HttpProducer.java:476) ~[camel-http-4.5.0.jar:4.5.0]
	at org.apache.camel.component.http.HttpProducer.process(HttpProducer.java:246) ~[camel-http-4.5.0.jar:4.5.0]
	at org.apache.camel.support.AsyncProcessorConverterHelper$ProcessorToAsyncProcessorBridge.process(AsyncProcessorConverterHelper.java:65) ~[camel-support-4.5.0.jar:4.5.0]
	at org.apache.camel.processor.SendDynamicProcessor.lambda$process$1(SendDynamicProcessor.java:225) ~[camel-core-processor-4.5.0.jar:4.5.0]
	at org.apache.camel.support.cache.DefaultProducerCache.doInAsyncProducer(DefaultProducerCache.java:281) ~[camel-support-4.5.0.jar:4.5.0]
	at org.apache.camel.processor.SendDynamicProcessor.process(SendDynamicProcessor.java:205) ~[camel-core-processor-4.5.0.jar:4.5.0]
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.handleFirst(RedeliveryErrorHandler.java:462) ~[camel-core-processor-4.5.0.jar:4.5.0]
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:438) ~[camel-core-processor-4.5.0.jar:4.5.0]
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.doRun(DefaultReactiveExecutor.java:199) ~[camel-base-engine-4.5.0.jar:4.5.0]
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.executeReactiveWork(DefaultReactiveExecutor.java:189) ~[camel-base-engine-4.5.0.jar:4.5.0]
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.tryExecuteReactiveWork(DefaultReactiveExecutor.java:166) ~[camel-base-engine-4.5.0.jar:4.5.0]
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148) ~[camel-base-engine-4.5.0.jar:4.5.0]
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:59) ~[camel-base-engine-4.5.0.jar:4.5.0]
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:163) ~[camel-core-processor-4.5.0.jar:4.5.0]
	at org.apache.camel.impl.engine.CamelInternalProcessor.processNonTransacted(CamelInternalProcessor.java:355) ~[camel-base-engine-4.5.0.jar:4.5.0]
	at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:331) ~[camel-base-engine-4.5.0.jar:4.5.0]
	at org.apache.camel.component.timer.TimerConsumer.sendTimerExchange(TimerConsumer.java:293) ~[camel-timer-4.5.0.jar:4.5.0]
	at org.apache.camel.component.timer.TimerConsumer$1.doRun(TimerConsumer.java:164) ~[camel-timer-4.5.0.jar:4.5.0]
	at org.apache.camel.component.timer.TimerConsumer$1.run(TimerConsumer.java:136) ~[camel-timer-4.5.0.jar:4.5.0]
	at java.base/java.util.TimerThread.mainLoop(Timer.java:566) ~[na:na]
	at java.base/java.util.TimerThread.run(Timer.java:516) ~[na:na]

2024-09-20T10:26:08.159+02:00  WARN 32156 --- [Camel (camel-1) thread #1 - timer://registerOpenHimMediator] o.a.camel.component.timer.TimerConsumer  : Error processing exchange. Exchange[CFAB2E92F46D010-0000000000000000]. Caused by: [org.apache.hc.client5.http.HttpHostConnectException - Connect to https://localhost:8080 [localhost/127.0.0.1, localhost/0:0:0:0:0:0:0:1] failed: Connection refused: no further information]

org.apache.hc.client5.http.HttpHostConnectException: Connect to https://localhost:8080 [localhost/127.0.0.1, localhost/0:0:0:0:0:0:0:1] failed: Connection refused: no further information
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:535) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:585) ~[na:na]
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:666) ~[na:na]
	at org.apache.hc.client5.http.ssl.SSLConnectionSocketFactory.lambda$connectSocket$0(SSLConnectionSocketFactory.java:246) ~[httpclient5-5.2.3.jar:5.2.3]
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:569) ~[na:na]
	at org.apache.hc.client5.http.ssl.SSLConnectionSocketFactory.connectSocket(SSLConnectionSocketFactory.java:245) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.io.DefaultHttpClientConnectionOperator.connect(DefaultHttpClientConnectionOperator.java:184) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.io.PoolingHttpClientConnectionManager.connect(PoolingHttpClientConnectionManager.java:447) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.InternalExecRuntime.connectEndpoint(InternalExecRuntime.java:162) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.InternalExecRuntime.connectEndpoint(InternalExecRuntime.java:172) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.ConnectExec.execute(ConnectExec.java:142) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.ExecChainElement.execute(ExecChainElement.java:51) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.ProtocolExec.execute(ProtocolExec.java:192) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.ExecChainElement.execute(ExecChainElement.java:51) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.HttpRequestRetryExec.execute(HttpRequestRetryExec.java:96) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.ExecChainElement.execute(ExecChainElement.java:51) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.ContentCompressionExec.execute(ContentCompressionExec.java:152) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.ExecChainElement.execute(ExecChainElement.java:51) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.camel.component.http.PreemptiveAuthExecChainHandler.execute(PreemptiveAuthExecChainHandler.java:70) ~[camel-http-4.5.0.jar:4.5.0]
	at org.apache.hc.client5.http.impl.classic.ExecChainElement.execute(ExecChainElement.java:51) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.InternalHttpClient.doExecute(InternalHttpClient.java:170) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.CloseableHttpClient.execute(CloseableHttpClient.java:245) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.camel.component.http.HttpProducer.executeMethod(HttpProducer.java:476) ~[camel-http-4.5.0.jar:4.5.0]
	at org.apache.camel.component.http.HttpProducer.process(HttpProducer.java:246) ~[camel-http-4.5.0.jar:4.5.0]
	at org.apache.camel.support.AsyncProcessorConverterHelper$ProcessorToAsyncProcessorBridge.process(AsyncProcessorConverterHelper.java:65) ~[camel-support-4.5.0.jar:4.5.0]
	at org.apache.camel.processor.SendDynamicProcessor.lambda$process$1(SendDynamicProcessor.java:225) ~[camel-core-processor-4.5.0.jar:4.5.0]
	at org.apache.camel.support.cache.DefaultProducerCache.doInAsyncProducer(DefaultProducerCache.java:281) ~[camel-support-4.5.0.jar:4.5.0]
	at org.apache.camel.processor.SendDynamicProcessor.process(SendDynamicProcessor.java:205) ~[camel-core-processor-4.5.0.jar:4.5.0]
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.handleFirst(RedeliveryErrorHandler.java:462) ~[camel-core-processor-4.5.0.jar:4.5.0]
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:438) ~[camel-core-processor-4.5.0.jar:4.5.0]
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.doRun(DefaultReactiveExecutor.java:199) ~[camel-base-engine-4.5.0.jar:4.5.0]
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.executeReactiveWork(DefaultReactiveExecutor.java:189) ~[camel-base-engine-4.5.0.jar:4.5.0]
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.tryExecuteReactiveWork(DefaultReactiveExecutor.java:166) ~[camel-base-engine-4.5.0.jar:4.5.0]
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148) ~[camel-base-engine-4.5.0.jar:4.5.0]
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:59) ~[camel-base-engine-4.5.0.jar:4.5.0]
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:163) ~[camel-core-processor-4.5.0.jar:4.5.0]
	at org.apache.camel.impl.engine.CamelInternalProcessor.processNonTransacted(CamelInternalProcessor.java:355) ~[camel-base-engine-4.5.0.jar:4.5.0]
	at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:331) ~[camel-base-engine-4.5.0.jar:4.5.0]
	at org.apache.camel.component.timer.TimerConsumer.sendTimerExchange(TimerConsumer.java:293) ~[camel-timer-4.5.0.jar:4.5.0]
	at org.apache.camel.component.timer.TimerConsumer$1.doRun(TimerConsumer.java:164) ~[camel-timer-4.5.0.jar:4.5.0]
	at org.apache.camel.component.timer.TimerConsumer$1.run(TimerConsumer.java:136) ~[camel-timer-4.5.0.jar:4.5.0]
	at java.base/java.util.TimerThread.mainLoop(Timer.java:566) ~[na:na]
	at java.base/java.util.TimerThread.run(Timer.java:516) ~[na:na]

2024-09-20T10:26:09.268+02:00  INFO 32156 --- [http-nio-127.0.0.1-auto-1-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2024-09-20T10:26:09.269+02:00  INFO 32156 --- [http-nio-127.0.0.1-auto-1-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2024-09-20T10:26:09.273+02:00  INFO 32156 --- [http-nio-127.0.0.1-auto-1-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 4 ms
2024-09-20T10:26:10.046+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   : Apache Camel 4.5.0 (camel-1) is shutting down (timeout:45s)
2024-09-20T10:26:10.056+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   : Routes stopped (total:3 rest-dsl:1)
2024-09-20T10:26:10.056+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   :     Stopped route1 (rest://get:/orgUnits)
2024-09-20T10:26:10.057+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   :     Stopped openHimHeartbeatRoute (timer://heartbeatOpenHimMediator)
2024-09-20T10:26:10.057+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   :     Stopped openHimRegisterRoute (timer://registerOpenHimMediator)
2024-09-20T10:26:10.064+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   : Apache Camel 4.5.0 (camel-1) shutdown in 17ms (uptime:3s)
2024-09-20T10:26:10.081+02:00  INFO 32156 --- [main] o.a.c.c.s.CamelHttpTransportServlet      : Destroyed CamelHttpTransportServlet[CamelServlet]
2024-09-20T10:26:10.082+02:00  INFO 32156 --- [main] io.hawt.web.auth.AuthenticationFilter    : Destroying hawtio authentication filter
2024-09-20T10:26:10.083+02:00  INFO 32156 --- [main] io.hawt.HawtioContextListener            : Destroying Hawtio services
2024-09-20T10:26:10.114+02:00  INFO 32156 --- [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [org.hisp.dhis.integration.camel.route.HelloWorldRouteBuilderFunctionalTestCase]: HelloWorldRouteBuilderFunctionalTestCase does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2024-09-20T10:26:10.131+02:00  INFO 32156 --- [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration org.hisp.dhis.integration.camel.Application for test class org.hisp.dhis.integration.camel.route.HelloWorldRouteBuilderFunctionalTestCase
2024-09-20T10:26:10.195+02:00  INFO 32156 --- [main] org.testcontainers.images.PullPolicy     : Image pull policy will be performed by: DefaultPullPolicy()
2024-09-20T10:26:10.200+02:00  INFO 32156 --- [main] o.t.utility.ImageNameSubstitutor         : Image name substitution will be performed by: DefaultImageNameSubstitutor (composite of 'ConfigurationFileImageNameSubstitutor' and 'PrefixingImageNameSubstitutor')
2024-09-20T10:26:10.531+02:00  INFO 32156 --- [main] o.t.d.DockerClientProviderStrategy       : Loaded org.testcontainers.dockerclient.NpipeSocketClientProviderStrategy from ~/.testcontainers.properties, will try it first
2024-09-20T10:26:10.931+02:00  INFO 32156 --- [main] o.t.d.DockerClientProviderStrategy       : Found Docker environment with local Npipe socket (npipe:////./pipe/docker_engine)
2024-09-20T10:26:10.933+02:00  INFO 32156 --- [main] org.testcontainers.DockerClientFactory   : Docker host IP address is localhost
2024-09-20T10:26:10.950+02:00  INFO 32156 --- [main] org.testcontainers.DockerClientFactory   : Connected to docker: 
  Server Version: 20.10.20
  API Version: 1.41
  Operating System: Docker Desktop
  Total Memory: 15838 MB
2024-09-20T10:26:10.975+02:00  INFO 32156 --- [main] tc.testcontainers/ryuk:0.6.0             : Creating container for image: testcontainers/ryuk:0.6.0
2024-09-20T10:26:13.891+02:00  INFO 32156 --- [main] o.t.utility.RegistryAuthLocator          : Credential helper/store (docker-credential-desktop) does not have credentials for https://index.docker.io/v1/
2024-09-20T10:26:14.014+02:00  INFO 32156 --- [main] tc.testcontainers/ryuk:0.6.0             : Container testcontainers/ryuk:0.6.0 is starting: 498b9901a49568890b3d909671bd47cd5570e6f4606b2623d551ea1198eeeac9
2024-09-20T10:26:14.700+02:00  INFO 32156 --- [main] tc.testcontainers/ryuk:0.6.0             : Container testcontainers/ryuk:0.6.0 started in PT3.7251645S
2024-09-20T10:26:14.705+02:00  INFO 32156 --- [main] o.t.utility.RyukResourceReaper           : Ryuk started - will monitor and terminate Testcontainers containers on JVM exit
2024-09-20T10:26:14.705+02:00  INFO 32156 --- [main] org.testcontainers.DockerClientFactory   : Checking the system...
2024-09-20T10:26:14.706+02:00  INFO 32156 --- [main] org.testcontainers.DockerClientFactory   : ✔︎ Docker server version should be at least 1.6.0
2024-09-20T10:26:14.707+02:00  INFO 32156 --- [main] tc.postgis/postgis:12-3.3-alpine         : Creating container for image: postgis/postgis:12-3.3-alpine
2024-09-20T10:26:16.355+02:00  INFO 32156 --- [main] tc.postgis/postgis:12-3.3-alpine         : Container postgis/postgis:12-3.3-alpine is starting: 058a599a6d21525beeac972b42579246778f91978927a6f302d78f5e77f8fdc4
2024-09-20T10:27:02.195+02:00  INFO 32156 --- [main] tc.postgis/postgis:12-3.3-alpine         : Container postgis/postgis:12-3.3-alpine started in PT47.487833S
2024-09-20T10:27:02.196+02:00  INFO 32156 --- [main] tc.postgis/postgis:12-3.3-alpine         : Container is started (JDBC URL: jdbc:postgresql://localhost:50305/dhis2?loggerLevel=OFF)
2024-09-20T10:27:02.203+02:00  INFO 32156 --- [main] tc.dhis2/core:2.40.3                     : Creating container for image: dhis2/core:2.40.3
2024-09-20T10:27:02.592+02:00  INFO 32156 --- [main] tc.dhis2/core:2.40.3                     : Container dhis2/core:2.40.3 is starting: 36be107d8dd04d1ac08c0b919e2a51d6ba989bb0883d3bea95d8891c9a319d52
2024-09-20T10:27:03.861+02:00  INFO 32156 --- [main] o.t.c.wait.strategy.HttpWaitStrategy     : /brave_sutherland: Waiting for 120 seconds for URL: http://localhost:50322/ (where port 50322 maps to container port 8080)
2024-09-20T10:27:46.634+02:00  INFO 32156 --- [main] tc.dhis2/core:2.40.3                     : Container dhis2/core:2.40.3 started in PT44.4307503S
2024-09-20T10:27:46.636+02:00  INFO 32156 --- [main] c.t.s.j.CamelSpringBootExecutionListener : CamelSpringBootExecutionListener preparing: class org.hisp.dhis.integration.camel.route.HelloWorldRouteBuilderFunctionalTestCase
2024-09-20T10:27:46.643+02:00  INFO 32156 --- [main] o.a.c.t.s.j.CamelAnnotationsHandler      : Disabling Camel JMX globally for tests by default. Use the DisableJMX annotation to override the default setting.
2024-09-20T10:27:46.697+02:00  WARN 32156 --- [main] ory$DuplicateJsonObjectContextCustomizer : 

Found multiple occurrences of org.json.JSONObject on the class path:

	jar:file:/C:/Users/JohanGangs%c3%a5sHole/.m2/repository/org/json/json/20240303/json-20240303.jar!/org/json/JSONObject.class
	jar:file:/C:/Users/JohanGangs%c3%a5sHole/.m2/repository/com/vaadin/external/google/android-json/0.0.20131108.vaadin1/android-json-0.0.20131108.vaadin1.jar!/org/json/JSONObject.class

You may wish to exclude one of them to ensure predictable runtime behavior

2024-09-20T10:27:46.700+02:00  INFO 32156 --- [main] HelloWorldRouteBuilderFunctionalTestCase : Starting HelloWorldRouteBuilderFunctionalTestCase using Java 19.0.1 with PID 32156 (started by JohanGangsåsHole in C:\Users\JohanGangsåsHole\Desktop\Work\repos\reference-fhir-civil-registry-lookup\oauth-route-middleware)
2024-09-20T10:27:46.701+02:00  INFO 32156 --- [main] HelloWorldRouteBuilderFunctionalTestCase : No active profile set, falling back to 1 default profile: "default"
2024-09-20T10:27:47.283+02:00  INFO 32156 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 0 (http)
2024-09-20T10:27:47.284+02:00  INFO 32156 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2024-09-20T10:27:47.285+02:00  INFO 32156 --- [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.19]
2024-09-20T10:27:47.360+02:00  INFO 32156 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2024-09-20T10:27:47.361+02:00  INFO 32156 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 656 ms
2024-09-20T10:27:47.416+02:00  INFO 32156 --- [main] o.s.b.a.e.web.ServletEndpointRegistrar   : Registered '/management/jolokia' to jolokia-actuator-endpoint
2024-09-20T10:27:47.416+02:00  INFO 32156 --- [main] io.hawt.HawtioContextListener            : Initialising Hawtio services
2024-09-20T10:27:47.417+02:00  INFO 32156 --- [main] i.h.w.auth.AuthenticationConfiguration   : Authentication throttling is enabled
2024-09-20T10:27:47.418+02:00  INFO 32156 --- [main] i.h.w.auth.AuthenticationConfiguration   : Starting hawtio authentication filter, JAAS authentication disabled
2024-09-20T10:27:47.419+02:00  INFO 32156 --- [main] io.hawt.web.auth.LoginRedirectFilter     : Hawtio loginRedirectFilter is using 1800 sec. HttpSession timeout
2024-09-20T10:27:47.493+02:00  WARN 32156 --- [main] .s.s.UserDetailsServiceAutoConfiguration : 

Using generated security password: b5d1124b-84fe-4ef6-8761-f93bcdfdfe1a

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2024-09-20T10:27:47.601+02:00  INFO 32156 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 18 endpoint(s) beneath base path '/management'
2024-09-20T10:27:47.612+02:00  INFO 32156 --- [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@787aa9f1, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@5d63295e, org.springframework.security.web.context.SecurityContextHolderFilter@1ad83fd7, org.springframework.security.web.header.HeaderWriterFilter@40aff4f1, org.springframework.web.filter.CorsFilter@36bc3c49, org.springframework.security.web.csrf.CsrfFilter@5e4b9f22, org.springframework.security.web.authentication.logout.LogoutFilter@4cbac3f, org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter@4e24b201, org.springframework.security.web.authentication.ui.DefaultLoginPageGeneratingFilter@78ffe38, org.springframework.security.web.authentication.ui.DefaultLogoutPageGeneratingFilter@1bebe505, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@17d745ae, org.hisp.dhis.integration.camel.security.DefaultSecurityConfig$CsrfCookieFilter@36f3f2a8, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@18681121, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@38388db2, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@721e04f1, org.springframework.security.web.access.ExceptionTranslationFilter@5b4f77e1, org.springframework.security.web.access.intercept.AuthorizationFilter@e4bb03]
2024-09-20T10:27:47.822+02:00  INFO 32156 --- [main] o.a.c.c.s.CamelHttpTransportServlet      : Initialized CamelHttpTransportServlet[name=CamelServlet, contextPath=]
2024-09-20T10:27:47.823+02:00  INFO 32156 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 50357 (http) with context path ''
2024-09-20T10:27:47.871+02:00  INFO 32156 --- [main] HelloWorldRouteBuilderFunctionalTestCase : Started HelloWorldRouteBuilderFunctionalTestCase in 1.225 seconds (process running for 109.656)
2024-09-20T10:27:47.876+02:00  INFO 32156 --- [main] o.a.c.t.s.j.CamelAnnotationsHandler      : Setting shutdown timeout to [10 SECONDS] on CamelContext with name [camelContext].
2024-09-20T10:27:47.886+02:00  INFO 32156 --- [main] c.t.s.j.CamelSpringBootExecutionListener : CamelSpringBootExecutionListener before: class org.hisp.dhis.integration.camel.route.HelloWorldRouteBuilderFunctionalTestCase.testConfigure
2024-09-20T10:27:47.886+02:00  INFO 32156 --- [main] c.t.s.j.CamelSpringBootExecutionListener : Initialized CamelSpringBootExecutionListener now ready to start CamelContext
2024-09-20T10:27:47.888+02:00  INFO 32156 --- [main] o.a.c.t.s.j.CamelAnnotationsHandler      : Starting CamelContext with name [camelContext].
2024-09-20T10:27:48.019+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   : Apache Camel 4.5.0 (camel-2) is starting
2024-09-20T10:27:48.032+02:00  INFO 32156 --- [main] c.s.b.CamelSpringBootApplicationListener : Starting CamelMainRunController to ensure the main thread keeps running
2024-09-20T10:27:48.033+02:00  INFO 32156 --- [CamelMainRunController] org.apache.camel.main.MainSupport        : Apache Camel (Main) 4.5.0 is starting
2024-09-20T10:27:48.034+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   : Routes startup (total:3 rest-dsl:1)
2024-09-20T10:27:48.034+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   :     Started openHimRegisterRoute (timer://registerOpenHimMediator)
2024-09-20T10:27:48.035+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   :     Started openHimHeartbeatRoute (timer://heartbeatOpenHimMediator)
2024-09-20T10:27:48.035+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   :     Started route2 (rest://get:/orgUnits)
2024-09-20T10:27:48.035+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   : Apache Camel 4.5.0 (camel-2) started in 14ms (build:0ms init:0ms start:14ms)
2024-09-20T10:27:49.053+02:00 ERROR 32156 --- [Camel (camel-2) thread #4 - timer://registerOpenHimMediator] o.a.c.p.e.DefaultErrorHandler            : Failed delivery for (MessageId: C78CA73B793AF4E-0000000000000000 on ExchangeId: C78CA73B793AF4E-0000000000000000). Exhausted after delivery attempt: 1 caught: org.apache.hc.client5.http.HttpHostConnectException: Connect to https://localhost:8080 [localhost/127.0.0.1, localhost/0:0:0:0:0:0:0:1] failed: Connection refused: no further information

Message History (source location and message history is disabled)
---------------------------------------------------------------------------------------------------------------------------------------
Source                                   ID                             Processor                                          Elapsed (ms)
                                         openHimRegisterRoute/openHimRe from[timer://registerOpenHimMediator?repeatCount=1           19
	...
                                         openHimRegisterRoute/toD3      {{openhim.url}}/mediators?httpClientConfigurer=#se            0

Stacktrace
---------------------------------------------------------------------------------------------------------------------------------------

org.apache.hc.client5.http.HttpHostConnectException: Connect to https://localhost:8080 [localhost/127.0.0.1, localhost/0:0:0:0:0:0:0:1] failed: Connection refused: no further information
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:535) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:585) ~[na:na]
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:666) ~[na:na]
	at org.apache.hc.client5.http.ssl.SSLConnectionSocketFactory.lambda$connectSocket$0(SSLConnectionSocketFactory.java:246) ~[httpclient5-5.2.3.jar:5.2.3]
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:569) ~[na:na]
	at org.apache.hc.client5.http.ssl.SSLConnectionSocketFactory.connectSocket(SSLConnectionSocketFactory.java:245) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.io.DefaultHttpClientConnectionOperator.connect(DefaultHttpClientConnectionOperator.java:184) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.io.PoolingHttpClientConnectionManager.connect(PoolingHttpClientConnectionManager.java:447) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.InternalExecRuntime.connectEndpoint(InternalExecRuntime.java:162) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.InternalExecRuntime.connectEndpoint(InternalExecRuntime.java:172) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.ConnectExec.execute(ConnectExec.java:142) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.ExecChainElement.execute(ExecChainElement.java:51) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.ProtocolExec.execute(ProtocolExec.java:192) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.ExecChainElement.execute(ExecChainElement.java:51) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.HttpRequestRetryExec.execute(HttpRequestRetryExec.java:96) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.ExecChainElement.execute(ExecChainElement.java:51) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.ContentCompressionExec.execute(ContentCompressionExec.java:152) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.ExecChainElement.execute(ExecChainElement.java:51) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.camel.component.http.PreemptiveAuthExecChainHandler.execute(PreemptiveAuthExecChainHandler.java:70) ~[camel-http-4.5.0.jar:4.5.0]
	at org.apache.hc.client5.http.impl.classic.ExecChainElement.execute(ExecChainElement.java:51) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.InternalHttpClient.doExecute(InternalHttpClient.java:170) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.CloseableHttpClient.execute(CloseableHttpClient.java:245) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.camel.component.http.HttpProducer.executeMethod(HttpProducer.java:476) ~[camel-http-4.5.0.jar:4.5.0]
	at org.apache.camel.component.http.HttpProducer.process(HttpProducer.java:246) ~[camel-http-4.5.0.jar:4.5.0]
	at org.apache.camel.support.AsyncProcessorConverterHelper$ProcessorToAsyncProcessorBridge.process(AsyncProcessorConverterHelper.java:65) ~[camel-support-4.5.0.jar:4.5.0]
	at org.apache.camel.processor.SendDynamicProcessor.lambda$process$1(SendDynamicProcessor.java:225) ~[camel-core-processor-4.5.0.jar:4.5.0]
	at org.apache.camel.support.cache.DefaultProducerCache.doInAsyncProducer(DefaultProducerCache.java:281) ~[camel-support-4.5.0.jar:4.5.0]
	at org.apache.camel.processor.SendDynamicProcessor.process(SendDynamicProcessor.java:205) ~[camel-core-processor-4.5.0.jar:4.5.0]
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.handleFirst(RedeliveryErrorHandler.java:462) ~[camel-core-processor-4.5.0.jar:4.5.0]
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:438) ~[camel-core-processor-4.5.0.jar:4.5.0]
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.doRun(DefaultReactiveExecutor.java:199) ~[camel-base-engine-4.5.0.jar:4.5.0]
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.executeReactiveWork(DefaultReactiveExecutor.java:189) ~[camel-base-engine-4.5.0.jar:4.5.0]
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.tryExecuteReactiveWork(DefaultReactiveExecutor.java:166) ~[camel-base-engine-4.5.0.jar:4.5.0]
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148) ~[camel-base-engine-4.5.0.jar:4.5.0]
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:59) ~[camel-base-engine-4.5.0.jar:4.5.0]
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:163) ~[camel-core-processor-4.5.0.jar:4.5.0]
	at org.apache.camel.impl.engine.CamelInternalProcessor.processNonTransacted(CamelInternalProcessor.java:355) ~[camel-base-engine-4.5.0.jar:4.5.0]
	at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:331) ~[camel-base-engine-4.5.0.jar:4.5.0]
	at org.apache.camel.component.timer.TimerConsumer.sendTimerExchange(TimerConsumer.java:293) ~[camel-timer-4.5.0.jar:4.5.0]
	at org.apache.camel.component.timer.TimerConsumer$1.doRun(TimerConsumer.java:164) ~[camel-timer-4.5.0.jar:4.5.0]
	at org.apache.camel.component.timer.TimerConsumer$1.run(TimerConsumer.java:136) ~[camel-timer-4.5.0.jar:4.5.0]
	at java.base/java.util.TimerThread.mainLoop(Timer.java:566) ~[na:na]
	at java.base/java.util.TimerThread.run(Timer.java:516) ~[na:na]

2024-09-20T10:27:49.054+02:00  WARN 32156 --- [Camel (camel-2) thread #4 - timer://registerOpenHimMediator] o.a.camel.component.timer.TimerConsumer  : Error processing exchange. Exchange[C78CA73B793AF4E-0000000000000000]. Caused by: [org.apache.hc.client5.http.HttpHostConnectException - Connect to https://localhost:8080 [localhost/127.0.0.1, localhost/0:0:0:0:0:0:0:1] failed: Connection refused: no further information]

org.apache.hc.client5.http.HttpHostConnectException: Connect to https://localhost:8080 [localhost/127.0.0.1, localhost/0:0:0:0:0:0:0:1] failed: Connection refused: no further information
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:535) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:585) ~[na:na]
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:666) ~[na:na]
	at org.apache.hc.client5.http.ssl.SSLConnectionSocketFactory.lambda$connectSocket$0(SSLConnectionSocketFactory.java:246) ~[httpclient5-5.2.3.jar:5.2.3]
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:569) ~[na:na]
	at org.apache.hc.client5.http.ssl.SSLConnectionSocketFactory.connectSocket(SSLConnectionSocketFactory.java:245) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.io.DefaultHttpClientConnectionOperator.connect(DefaultHttpClientConnectionOperator.java:184) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.io.PoolingHttpClientConnectionManager.connect(PoolingHttpClientConnectionManager.java:447) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.InternalExecRuntime.connectEndpoint(InternalExecRuntime.java:162) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.InternalExecRuntime.connectEndpoint(InternalExecRuntime.java:172) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.ConnectExec.execute(ConnectExec.java:142) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.ExecChainElement.execute(ExecChainElement.java:51) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.ProtocolExec.execute(ProtocolExec.java:192) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.ExecChainElement.execute(ExecChainElement.java:51) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.HttpRequestRetryExec.execute(HttpRequestRetryExec.java:96) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.ExecChainElement.execute(ExecChainElement.java:51) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.ContentCompressionExec.execute(ContentCompressionExec.java:152) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.ExecChainElement.execute(ExecChainElement.java:51) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.camel.component.http.PreemptiveAuthExecChainHandler.execute(PreemptiveAuthExecChainHandler.java:70) ~[camel-http-4.5.0.jar:4.5.0]
	at org.apache.hc.client5.http.impl.classic.ExecChainElement.execute(ExecChainElement.java:51) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.InternalHttpClient.doExecute(InternalHttpClient.java:170) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.hc.client5.http.impl.classic.CloseableHttpClient.execute(CloseableHttpClient.java:245) ~[httpclient5-5.2.3.jar:5.2.3]
	at org.apache.camel.component.http.HttpProducer.executeMethod(HttpProducer.java:476) ~[camel-http-4.5.0.jar:4.5.0]
	at org.apache.camel.component.http.HttpProducer.process(HttpProducer.java:246) ~[camel-http-4.5.0.jar:4.5.0]
	at org.apache.camel.support.AsyncProcessorConverterHelper$ProcessorToAsyncProcessorBridge.process(AsyncProcessorConverterHelper.java:65) ~[camel-support-4.5.0.jar:4.5.0]
	at org.apache.camel.processor.SendDynamicProcessor.lambda$process$1(SendDynamicProcessor.java:225) ~[camel-core-processor-4.5.0.jar:4.5.0]
	at org.apache.camel.support.cache.DefaultProducerCache.doInAsyncProducer(DefaultProducerCache.java:281) ~[camel-support-4.5.0.jar:4.5.0]
	at org.apache.camel.processor.SendDynamicProcessor.process(SendDynamicProcessor.java:205) ~[camel-core-processor-4.5.0.jar:4.5.0]
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.handleFirst(RedeliveryErrorHandler.java:462) ~[camel-core-processor-4.5.0.jar:4.5.0]
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:438) ~[camel-core-processor-4.5.0.jar:4.5.0]
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.doRun(DefaultReactiveExecutor.java:199) ~[camel-base-engine-4.5.0.jar:4.5.0]
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.executeReactiveWork(DefaultReactiveExecutor.java:189) ~[camel-base-engine-4.5.0.jar:4.5.0]
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.tryExecuteReactiveWork(DefaultReactiveExecutor.java:166) ~[camel-base-engine-4.5.0.jar:4.5.0]
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148) ~[camel-base-engine-4.5.0.jar:4.5.0]
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:59) ~[camel-base-engine-4.5.0.jar:4.5.0]
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:163) ~[camel-core-processor-4.5.0.jar:4.5.0]
	at org.apache.camel.impl.engine.CamelInternalProcessor.processNonTransacted(CamelInternalProcessor.java:355) ~[camel-base-engine-4.5.0.jar:4.5.0]
	at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:331) ~[camel-base-engine-4.5.0.jar:4.5.0]
	at org.apache.camel.component.timer.TimerConsumer.sendTimerExchange(TimerConsumer.java:293) ~[camel-timer-4.5.0.jar:4.5.0]
	at org.apache.camel.component.timer.TimerConsumer$1.doRun(TimerConsumer.java:164) ~[camel-timer-4.5.0.jar:4.5.0]
	at org.apache.camel.component.timer.TimerConsumer$1.run(TimerConsumer.java:136) ~[camel-timer-4.5.0.jar:4.5.0]
	at java.base/java.util.TimerThread.mainLoop(Timer.java:566) ~[na:na]
	at java.base/java.util.TimerThread.run(Timer.java:516) ~[na:na]

2024-09-20T10:27:50.507+02:00  INFO 32156 --- [main] HelloWorldRouteBuilderFunctionalTestCase : ********************************************************************************
2024-09-20T10:27:50.508+02:00  INFO 32156 --- [main] HelloWorldRouteBuilderFunctionalTestCase : Testing done: testConfigure (org.hisp.dhis.integration.camel.route.HelloWorldRouteBuilderFunctionalTestCase)
2024-09-20T10:27:50.508+02:00  INFO 32156 --- [main] HelloWorldRouteBuilderFunctionalTestCase : Took: 2s472ms (2472 millis)
2024-09-20T10:27:50.508+02:00  INFO 32156 --- [main] HelloWorldRouteBuilderFunctionalTestCase : ********************************************************************************
2024-09-20T10:27:50.508+02:00  INFO 32156 --- [main] c.t.s.j.CamelSpringBootExecutionListener : CamelSpringBootExecutionListener after: class org.hisp.dhis.integration.camel.route.HelloWorldRouteBuilderFunctionalTestCase.testConfigure
2024-09-20T10:27:50.513+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   : Apache Camel 4.5.0 (camel-2) is shutting down (timeout:10s)
2024-09-20T10:27:50.515+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   : Routes stopped (total:3 rest-dsl:1)
2024-09-20T10:27:50.515+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   :     Stopped route2 (rest://get:/orgUnits)
2024-09-20T10:27:50.516+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   :     Stopped openHimHeartbeatRoute (timer://heartbeatOpenHimMediator)
2024-09-20T10:27:50.516+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   :     Stopped openHimRegisterRoute (timer://registerOpenHimMediator)
2024-09-20T10:27:50.517+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   : Apache Camel 4.5.0 (camel-2) shutdown in 4ms (uptime:2s)
2024-09-20T10:27:50.522+02:00  INFO 32156 --- [main] o.a.c.c.s.CamelHttpTransportServlet      : Destroyed CamelHttpTransportServlet[CamelServlet]
2024-09-20T10:27:50.522+02:00  INFO 32156 --- [main] io.hawt.web.auth.AuthenticationFilter    : Destroying hawtio authentication filter
2024-09-20T10:27:50.522+02:00  INFO 32156 --- [main] io.hawt.HawtioContextListener            : Destroying Hawtio services
2024-09-20T10:27:50.532+02:00  INFO 32156 --- [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [org.hisp.dhis.integration.camel.route.OpenHimMediatorRouteBuilderTestCase]: OpenHimMediatorRouteBuilderTestCase does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2024-09-20T10:27:50.534+02:00  INFO 32156 --- [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration org.hisp.dhis.integration.camel.Application for test class org.hisp.dhis.integration.camel.route.OpenHimMediatorRouteBuilderTestCase
2024-09-20T10:27:50.537+02:00  INFO 32156 --- [main] c.t.s.j.CamelSpringBootExecutionListener : CamelSpringBootExecutionListener preparing: class org.hisp.dhis.integration.camel.route.OpenHimMediatorRouteBuilderTestCase
2024-09-20T10:27:50.537+02:00  INFO 32156 --- [main] o.a.c.t.s.j.CamelAnnotationsHandler      : Disabling Camel JMX globally for tests by default. Use the DisableJMX annotation to override the default setting.
2024-09-20T10:27:50.580+02:00  WARN 32156 --- [main] ory$DuplicateJsonObjectContextCustomizer : 

Found multiple occurrences of org.json.JSONObject on the class path:

	jar:file:/C:/Users/JohanGangs%c3%a5sHole/.m2/repository/org/json/json/20240303/json-20240303.jar!/org/json/JSONObject.class
	jar:file:/C:/Users/JohanGangs%c3%a5sHole/.m2/repository/com/vaadin/external/google/android-json/0.0.20131108.vaadin1/android-json-0.0.20131108.vaadin1.jar!/org/json/JSONObject.class

You may wish to exclude one of them to ensure predictable runtime behavior

2024-09-20T10:27:50.581+02:00  INFO 32156 --- [main] .c.r.OpenHimMediatorRouteBuilderTestCase : Starting OpenHimMediatorRouteBuilderTestCase using Java 19.0.1 with PID 32156 (started by JohanGangsåsHole in C:\Users\JohanGangsåsHole\Desktop\Work\repos\reference-fhir-civil-registry-lookup\oauth-route-middleware)
2024-09-20T10:27:50.582+02:00  INFO 32156 --- [main] .c.r.OpenHimMediatorRouteBuilderTestCase : No active profile set, falling back to 1 default profile: "default"
2024-09-20T10:27:51.088+02:00  INFO 32156 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 0 (http)
2024-09-20T10:27:51.089+02:00  INFO 32156 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2024-09-20T10:27:51.089+02:00  INFO 32156 --- [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.19]
2024-09-20T10:27:51.169+02:00  INFO 32156 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2024-09-20T10:27:51.169+02:00  INFO 32156 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 585 ms
2024-09-20T10:27:51.221+02:00  INFO 32156 --- [main] o.s.b.a.e.web.ServletEndpointRegistrar   : Registered '/management/jolokia' to jolokia-actuator-endpoint
2024-09-20T10:27:51.221+02:00  INFO 32156 --- [main] io.hawt.HawtioContextListener            : Initialising Hawtio services
2024-09-20T10:27:51.222+02:00  INFO 32156 --- [main] i.h.w.auth.AuthenticationConfiguration   : Authentication throttling is enabled
2024-09-20T10:27:51.222+02:00  INFO 32156 --- [main] i.h.w.auth.AuthenticationConfiguration   : Starting hawtio authentication filter, JAAS authentication disabled
2024-09-20T10:27:51.223+02:00  INFO 32156 --- [main] io.hawt.web.auth.LoginRedirectFilter     : Hawtio loginRedirectFilter is using 1800 sec. HttpSession timeout
2024-09-20T10:27:51.299+02:00  WARN 32156 --- [main] .s.s.UserDetailsServiceAutoConfiguration : 

Using generated security password: 42e4ad6a-3173-4928-a4c7-9afade4c107d

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2024-09-20T10:27:51.386+02:00  INFO 32156 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 18 endpoint(s) beneath base path '/management'
2024-09-20T10:27:51.397+02:00  INFO 32156 --- [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@62cfb51a, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@6b542adc, org.springframework.security.web.context.SecurityContextHolderFilter@45e4debe, org.springframework.security.web.header.HeaderWriterFilter@14d428d8, org.springframework.web.filter.CorsFilter@45ca07cf, org.springframework.security.web.csrf.CsrfFilter@432c9f47, org.springframework.security.web.authentication.logout.LogoutFilter@740ba30d, org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter@3073c879, org.springframework.security.web.authentication.ui.DefaultLoginPageGeneratingFilter@581c0da6, org.springframework.security.web.authentication.ui.DefaultLogoutPageGeneratingFilter@14676d59, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@194916b1, org.hisp.dhis.integration.camel.security.DefaultSecurityConfig$CsrfCookieFilter@b9f6daa, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@6295b7e2, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@6d3b6a31, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@41d7b4cf, org.springframework.security.web.access.ExceptionTranslationFilter@1ce27871, org.springframework.security.web.access.intercept.AuthorizationFilter@7a9e618e]
2024-09-20T10:27:51.539+02:00  INFO 32156 --- [main] o.a.c.c.s.CamelHttpTransportServlet      : Initialized CamelHttpTransportServlet[name=CamelServlet, contextPath=]
2024-09-20T10:27:51.539+02:00  INFO 32156 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 50363 (http) with context path ''
2024-09-20T10:27:51.579+02:00  INFO 32156 --- [main] .c.r.OpenHimMediatorRouteBuilderTestCase : Started OpenHimMediatorRouteBuilderTestCase in 1.039 seconds (process running for 113.365)
2024-09-20T10:27:51.581+02:00  INFO 32156 --- [main] o.a.c.t.s.j.CamelAnnotationsHandler      : Setting shutdown timeout to [10 SECONDS] on CamelContext with name [camelContext].
2024-09-20T10:27:51.588+02:00  INFO 32156 --- [main] c.t.s.j.CamelSpringBootExecutionListener : CamelSpringBootExecutionListener before: class org.hisp.dhis.integration.camel.route.OpenHimMediatorRouteBuilderTestCase.testRegisterMediatorRoute
2024-09-20T10:27:51.588+02:00  INFO 32156 --- [main] c.t.s.j.CamelSpringBootExecutionListener : Initialized CamelSpringBootExecutionListener now ready to start CamelContext
2024-09-20T10:27:51.588+02:00  INFO 32156 --- [main] o.a.c.t.s.j.CamelAnnotationsHandler      : Skipping starting CamelContext(s) as UseAdviceWith annotation was found and isUseAdviceWith is set to true.
2024-09-20T10:27:52.211+02:00  INFO 32156 --- [main] o.apache.camel.builder.AdviceWithTasks   : AdviceWith (ToDynamicDefinition) : [DynamicTo[{{openhim.url}}/mediators?httpClientConfigurer=#selfSignedHttpClientConfigurer&authUsername={{openhim.username}}&authPassword={{openhim.password}}&authenticationPreemptive=true]] --> replace [To[mock:register]]
2024-09-20T10:27:52.211+02:00  INFO 32156 --- [main] org.apache.camel.builder.AdviceWith      : AdviceWith route after: Route(openHimRegisterRoute)[From[timer://registerOpenHimMediator?repeatCount=1] -> [Transform[datasonnet{resource:classpath:openhim/mediator-config.ds}], SetHeader[CamelHttpMethod, POST], To[mock:register]]]
2024-09-20T10:27:52.215+02:00  INFO 32156 --- [main] org.apache.camel.builder.AdviceWith      : Adviced route before/after as XML:
<route xmlns="http://camel.apache.org/schema/spring" id="openHimRegisterRoute">
    <from uri="timer://registerOpenHimMediator?repeatCount=1"/>
    <transform>
        <datasonnet bodyMediaType="application/x-java-object" outputMediaType="application/json">resource:classpath:openhim/mediator-config.ds</datasonnet>
    </transform>
    <setHeader name="CamelHttpMethod">
        <expressionDefinition/>
    </setHeader>
    <toD uri="{{openhim.url}}/mediators?httpClientConfigurer=#selfSignedHttpClientConfigurer&amp;authUsername={{openhim.username}}&amp;authPassword={{openhim.password}}&amp;authenticationPreemptive=true"/>
</route>

<route xmlns="http://camel.apache.org/schema/spring" id="openHimRegisterRoute">
    <from uri="timer://registerOpenHimMediator?repeatCount=1"/>
    <transform>
        <datasonnet bodyMediaType="application/x-java-object" outputMediaType="application/json">resource:classpath:openhim/mediator-config.ds</datasonnet>
    </transform>
    <setHeader name="CamelHttpMethod">
        <expressionDefinition/>
    </setHeader>
    <to uri="mock:register"/>
</route>
2024-09-20T10:27:52.293+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   : Apache Camel 4.5.0 (camel-3) is starting
2024-09-20T10:27:52.299+02:00  INFO 32156 --- [main] c.s.b.CamelSpringBootApplicationListener : Starting CamelMainRunController to ensure the main thread keeps running
2024-09-20T10:27:52.300+02:00  INFO 32156 --- [CamelMainRunController] org.apache.camel.main.MainSupport        : Apache Camel (Main) 4.5.0 is starting
2024-09-20T10:27:52.301+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   : Routes startup (total:3 rest-dsl:1)
2024-09-20T10:27:52.301+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   :     Started openHimRegisterRoute (timer://registerOpenHimMediator)
2024-09-20T10:27:52.301+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   :     Started openHimHeartbeatRoute (timer://heartbeatOpenHimMediator)
2024-09-20T10:27:52.301+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   :     Started route3 (rest://get:/orgUnits)
2024-09-20T10:27:52.301+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   : Apache Camel 4.5.0 (camel-3) started in 7ms (build:0ms init:0ms start:7ms)
2024-09-20T10:27:53.315+02:00  INFO 32156 --- [main] .c.r.OpenHimMediatorRouteBuilderTestCase : ********************************************************************************
2024-09-20T10:27:53.315+02:00  INFO 32156 --- [main] .c.r.OpenHimMediatorRouteBuilderTestCase : Testing done: testRegisterMediatorRoute (org.hisp.dhis.integration.camel.route.OpenHimMediatorRouteBuilderTestCase)
2024-09-20T10:27:53.315+02:00  INFO 32156 --- [main] .c.r.OpenHimMediatorRouteBuilderTestCase : Took: 1s726ms (1726 millis)
2024-09-20T10:27:53.315+02:00  INFO 32156 --- [main] .c.r.OpenHimMediatorRouteBuilderTestCase : ********************************************************************************
2024-09-20T10:27:53.315+02:00  INFO 32156 --- [main] c.t.s.j.CamelSpringBootExecutionListener : CamelSpringBootExecutionListener after: class org.hisp.dhis.integration.camel.route.OpenHimMediatorRouteBuilderTestCase.testRegisterMediatorRoute
2024-09-20T10:27:53.316+02:00  INFO 32156 --- [main] c.t.s.j.CamelSpringBootExecutionListener : CamelSpringBootExecutionListener preparing: class org.hisp.dhis.integration.camel.route.OpenHimMediatorRouteBuilderTestCase
2024-09-20T10:27:53.316+02:00  INFO 32156 --- [main] o.a.c.t.s.j.CamelAnnotationsHandler      : Disabling Camel JMX globally for tests by default. Use the DisableJMX annotation to override the default setting.
2024-09-20T10:27:53.316+02:00  INFO 32156 --- [main] o.a.c.t.s.j.CamelAnnotationsHandler      : Setting shutdown timeout to [10 SECONDS] on CamelContext with name [camelContext].
2024-09-20T10:27:53.317+02:00  INFO 32156 --- [main] c.t.s.j.CamelSpringBootExecutionListener : CamelSpringBootExecutionListener before: class org.hisp.dhis.integration.camel.route.OpenHimMediatorRouteBuilderTestCase.testHeartbeatRoute
2024-09-20T10:27:53.317+02:00  INFO 32156 --- [main] c.t.s.j.CamelSpringBootExecutionListener : Initialized CamelSpringBootExecutionListener now ready to start CamelContext
2024-09-20T10:27:53.317+02:00  INFO 32156 --- [main] o.a.c.t.s.j.CamelAnnotationsHandler      : Skipping starting CamelContext(s) as UseAdviceWith annotation was found and isUseAdviceWith is set to true.
2024-09-20T10:27:53.323+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   : Stopped openHimHeartbeatRoute (timer://heartbeatOpenHimMediator)
2024-09-20T10:27:53.323+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   : Shutdown openHimHeartbeatRoute (timer://heartbeatOpenHimMediator)
2024-09-20T10:27:53.324+02:00  INFO 32156 --- [main] o.apache.camel.builder.AdviceWithTasks   : AdviceWith (ToDynamicDefinition) : [DynamicTo[{{openhim.url}}/mediators/urn:mediator:oauth-route-middleware/heartbeat?httpClientConfigurer=#selfSignedHttpClientConfigurer&authUsername={{openhim.username}}&authPassword={{openhim.password}}&authenticationPreemptive=true]] --> replace [To[mock:heartbeat]]
2024-09-20T10:27:53.324+02:00  INFO 32156 --- [main] org.apache.camel.builder.AdviceWith      : AdviceWith route after: Route(openHimHeartbeatRoute)[From[timer://heartbeatOpenHimMediator?delay=10000&fixedRate=true&period=5000] -> [SetProperty[uptime, org.hisp.dhis.integration.camel.UptimeExpression@5223eb62], Transform[datasonnet{resource:classpath:openhim/heartbeat.ds}], SetHeader[CamelHttpMethod, POST], To[mock:heartbeat]]]
2024-09-20T10:27:53.327+02:00  INFO 32156 --- [main] org.apache.camel.builder.AdviceWith      : Adviced route before/after as XML:
<route xmlns="http://camel.apache.org/schema/spring" id="openHimHeartbeatRoute">
    <from id="from8" uri="timer://heartbeatOpenHimMediator?delay=10000&amp;fixedRate=true&amp;period=5000"/>
    <setProperty id="setProperty3" name="uptime">
        <expressionDefinition>org.hisp.dhis.integration.camel.UptimeExpression@5223eb62</expressionDefinition>
    </setProperty>
    <transform id="transform6">
        <datasonnet bodyMediaType="application/x-java-object" outputMediaType="application/json">resource:classpath:openhim/heartbeat.ds</datasonnet>
    </transform>
    <setHeader id="setHeader6" name="CamelHttpMethod">
        <expressionDefinition>POST</expressionDefinition>
    </setHeader>
    <toD id="toD5" uri="{{openhim.url}}/mediators/urn:mediator:oauth-route-middleware/heartbeat?httpClientConfigurer=#selfSignedHttpClientConfigurer&amp;authUsername={{openhim.username}}&amp;authPassword={{openhim.password}}&amp;authenticationPreemptive=true"/>
</route>

<route xmlns="http://camel.apache.org/schema/spring" id="openHimHeartbeatRoute">
    <from id="from8" uri="timer://heartbeatOpenHimMediator?delay=10000&amp;fixedRate=true&amp;period=5000"/>
    <setProperty id="setProperty3" name="uptime">
        <expressionDefinition>org.hisp.dhis.integration.camel.UptimeExpression@5223eb62</expressionDefinition>
    </setProperty>
    <transform id="transform6">
        <datasonnet bodyMediaType="application/x-java-object" outputMediaType="application/json">resource:classpath:openhim/heartbeat.ds</datasonnet>
    </transform>
    <setHeader id="setHeader6" name="CamelHttpMethod">
        <expressionDefinition>POST</expressionDefinition>
    </setHeader>
    <to uri="mock:heartbeat"/>
</route>
2024-09-20T10:28:03.339+02:00  INFO 32156 --- [main] .c.r.OpenHimMediatorRouteBuilderTestCase : ********************************************************************************
2024-09-20T10:28:03.340+02:00  INFO 32156 --- [main] .c.r.OpenHimMediatorRouteBuilderTestCase : Testing done: testHeartbeatRoute (org.hisp.dhis.integration.camel.route.OpenHimMediatorRouteBuilderTestCase)
2024-09-20T10:28:03.340+02:00  INFO 32156 --- [main] .c.r.OpenHimMediatorRouteBuilderTestCase : Took: 10s21ms (10021 millis)
2024-09-20T10:28:03.340+02:00  INFO 32156 --- [main] .c.r.OpenHimMediatorRouteBuilderTestCase : ********************************************************************************
2024-09-20T10:28:03.340+02:00  INFO 32156 --- [main] c.t.s.j.CamelSpringBootExecutionListener : CamelSpringBootExecutionListener after: class org.hisp.dhis.integration.camel.route.OpenHimMediatorRouteBuilderTestCase.testHeartbeatRoute
2024-09-20T10:28:03.342+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   : Apache Camel 4.5.0 (camel-3) is shutting down (timeout:10s)
2024-09-20T10:28:03.343+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   : Routes stopped (total:3 rest-dsl:1)
2024-09-20T10:28:03.343+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   :     Stopped openHimHeartbeatRoute (timer://heartbeatOpenHimMediator)
2024-09-20T10:28:03.343+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   :     Stopped route3 (rest://get:/orgUnits)
2024-09-20T10:28:03.343+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   :     Stopped openHimRegisterRoute (timer://registerOpenHimMediator)
2024-09-20T10:28:03.343+02:00  INFO 32156 --- [main] o.a.c.impl.engine.AbstractCamelContext   : Apache Camel 4.5.0 (camel-3) shutdown in 1ms (uptime:11s)
2024-09-20T10:28:03.345+02:00  INFO 32156 --- [main] o.a.c.c.s.CamelHttpTransportServlet      : Destroyed CamelHttpTransportServlet[CamelServlet]
2024-09-20T10:28:03.345+02:00  INFO 32156 --- [main] io.hawt.web.auth.AuthenticationFilter    : Destroying hawtio authentication filter
2024-09-20T10:28:03.345+02:00  INFO 32156 --- [main] io.hawt.HawtioContextListener            : Destroying Hawtio services
